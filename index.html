<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Викторина (без 3D) — мобильная</title>

  <style>
    :root{
      --bg:#f6f8fb; --card:#ffffff; --accent:#0b74de; --ok:#2e7d32; --bad:#c62828; --muted:#6b7280;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:#111}
    .wrap{max-width:760px;margin:0 auto;padding:18px}
    header{display:flex;gap:12px;align-items:center;margin-bottom:12px}
    h1{font-size:1.1rem;margin:0}
    .progress{margin-left:auto;color:var(--muted);font-size:.95rem}
    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(17,24,39,0.06)}
    .question-number{font-size:.9rem;color:var(--muted);margin-bottom:6px}
    .question{font-weight:600;font-size:1.05rem;margin-bottom:12px}
    .options{display:grid;gap:8px}
    .option{padding:12px;border-radius:10px;border:1px solid #e6eef8;background:#fff;text-align:left;cursor:pointer;font-size:.98rem}
    .option:active{transform:translateY(1px)}
    .option.correct{background:#dff0df;border-color:var(--ok);color:#0b3f18}
    .option.wrong{background:#ffe1e1;border-color:var(--bad);color:#5b1212}
    .hidden{display:none}
    .center{display:flex;gap:8px;align-items:center;justify-content:center}
    footer{margin-top:14px;color:var(--muted);font-size:.9rem;text-align:center}
    .btn{display:inline-block;padding:10px 14px;border-radius:10px;border:none;background:var(--accent);color:#fff;font-weight:600;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent);border:1px solid rgba(11,116,222,0.12)}
    .small{font-size:.88rem;color:var(--muted)}
    @media (max-width:420px){ .question{font-size:1rem} }
    /* placeholder for AR panel */
    .ar-placeholder{height:260px;border-radius:10px;background:linear-gradient(180deg,#f0f4ff,#fff);display:flex;align-items:center;justify-content:center;flex-direction:column;padding:18px;text-align:center}
    .stats{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .chip{background:#f3f6fb;padding:8px 10px;border-radius:999px;font-weight:600;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Викторина — подготовка к AR</h1>
      <div class="progress" id="progress">Блок 1 / 6</div>
    </header>

    <!-- Quiz card -->
    <div id="quiz" class="card">
      <div class="question-number" id="q-info">Вопрос 1 из 4</div>
      <div class="question" id="q-text">Загрузка...</div>
      <div class="options" id="options"></div>

      <div class="stats" id="stats" style="margin-top:12px">
        <div class="chip">Правильных в блоке: <span id="block-correct">0</span></div>
        <div class="chip">Всего правильных: <span id="total-correct">0</span></div>
      </div>
    </div>

    <!-- AR / 3D placeholder panel (без моделей пока) -->
    <div id="ar-panel" class="card hidden" style="margin-top:12px">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <div>
          <strong id="ar-title">Панель после блока</strong>
          <div class="small">Здесь позже будет 3D/AR сцена. Пока — заглушка.</div>
        </div>
        <div><button id="continue-btn" class="btn">Продолжить</button></div>
      </div>

      <div class="ar-placeholder">
        <div style="font-weight:700;margin-bottom:6px" id="ar-msg">Поздравляем! Блок завершён.</div>
        <div class="small">Когда добавишь модели — заменить этот блок на &lt;model-viewer&gt; и положить файлы в models/</div>
      </div>
    </div>

    <!-- Final screen -->
    <footer id="final" class="hidden">
      <div class="card center" style="flex-direction:column;gap:10px;padding:18px">
        <div id="final-text" style="font-weight:700">Викторина завершена — спасибо!</div>
        <div class="small">Правильных ответов всего: <span id="final-total">0</span></div>
        <div style="display:flex;gap:8px">
          <button id="restart" class="btn">Перезапустить</button>
        </div>
      </div>
    </footer>
  </div>

<script>
/*
  Настройки/данные:
  - 6 блоков по 4 вопроса (можно править тексты ниже)
  - Когда позже добавишь 3D модели, положи их в /models/block1.glb ... block6.glb
*/
const blocks = [
  { title:'Блок 1', model:'models/block1.glb', questions:[
      {q:'Столица Франции?', options:['Барселона','Париж','Рим','Берлин'], answer:1},
      {q:'2 + 2 = ?', options:['3','4','5','6'], answer:1},
      {q:'Какой цвет при смешении синего и желтого?', options:['Фиолетовый','Зелёный','Оранжевый','Чёрный'], answer:1},
      {q:'Какая планета ближе всего к Солнцу?', options:['Земля','Марс','Меркурий','Венера'], answer:2}
  ]},
  { title:'Блок 2', model:'models/block2.glb', questions:[
      {q:'Сколько часов в сутках?', options:['20','24','22','26'], answer:1},
      {q:'Какой газ необходим для дыхания?', options:['Кислород','Азот','Водород','CO₂'], answer:0},
      {q:'Какой год високосный?', options:['2023','2024','2025','2026'], answer:1},
      {q:'Сколько сторон у квадрата?', options:['3','4','5','6'], answer:1}
  ]},
  { title:'Блок 3', model:'models/block3.glb', questions:[
      {q:'HTML — это?', options:['Язык стилей','Язык разметки','Язык программирования','База данных'], answer:1},
      {q:'CSS управляет?', options:['Структурой','Данными','Стилем','Сервером'], answer:2},
      {q:'JS расшифровывается как?', options:['JavaScript','JustScript','JorgeScript','JointScript'], answer:0},
      {q:'Что делает model-viewer?', options:['Отправляет почту','Отображает 3D','Запускает сервер','Редактирует видео'], answer:1}
  ]},
  { title:'Блок 4', model:'models/block4.glb', questions:[
      {q:'Какой океан самый большой?', options:['Атлантический','Индийский','Тихий','Северный Ледовитый'], answer:2},
      {q:'Сколько континентов на Земле?', options:['5','6','7','8'], answer:2},
      {q:'Какая часть растения — за фотосинтез?', options:['Корень','Стебель','Лист','Цветок'], answer:2},
      {q:'Самая высокая гора?', options:['К2','Эверест','Мак-Кинли','Килиманджаро'], answer:1}
  ]},
  { title:'Блок 5', model:'models/block5.glb', questions:[
      {q:'HTML элемент для заголовка?', options:['<p>','<h1>','<div>','<span>'], answer:1},
      {q:'Тег для ссылок?', options:['<a>','<link>','<href>','<url>'], answer:0},
      {q:'Атрибут у model-viewer для AR?', options:['ar','xr','vr','mode'], answer:0},
      {q:'Что такое GLB?', options:['Текстовый формат','Бинарный glTF','Изображение','Аудиофайл'], answer:1}
  ]},
  { title:'Блок 6', model:'models/block6.glb', questions:[
      {q:'Что такое GitHub Pages?', options:['СУБД','Хостинг статических сайтов','IDE','Язык программирования'], answer:1},
      {q:'Расширение для glTF?', options:['.png','.glb','.mp3','.pdf'], answer:1},
      {q:'Как выглядит элемент button в HTML?', options:['<btn>','<button>','<a>','<input>'], answer:1},
      {q:'Последний вопрос — тест завершён?', options:['Да','Нет','Может быть','Ещё нет'], answer:0}
  ]}
];

let currentBlock = 0;
let currentQuestion = 0;
let answered = false;
let totalCorrect = 0;
let blockCorrect = 0;

const qInfo = document.getElementById('q-info');
const qText = document.getElementById('q-text');
const optionsEl = document.getElementById('options');
const progress = document.getElementById('progress');
const quiz = document.getElementById('quiz');
const arPanel = document.getElementById('ar-panel');
const arTitle = document.getElementById('ar-title');
const arMsg = document.getElementById('ar-msg');
const continueBtn = document.getElementById('continue-btn');
const final = document.getElementById('final');
const restart = document.getElementById('restart');
const blockCorrectEl = document.getElementById('block-correct');
const totalCorrectEl = document.getElementById('total-correct');
const finalTotal = document.getElementById('final-total');

function renderQuestion(){
  const block = blocks[currentBlock];
  const q = block.questions[currentQuestion];
  progress.textContent = `Блок ${currentBlock+1} / ${blocks.length}`;
  qInfo.textContent = `Вопрос ${currentQuestion+1} из ${block.questions.length}`;
  qText.textContent = q.q;
  optionsEl.innerHTML = '';
  q.options.forEach((opt, idx)=>{
    const b = document.createElement('button');
    b.className = 'option';
    b.type = 'button';
    b.textContent = opt;
    b.addEventListener('click', ()=>selectOption(idx, b));
    optionsEl.appendChild(b);
  });
  // обновить счетчики на экране
  blockCorrectEl.textContent = blockCorrect;
  totalCorrectEl.textContent = totalCorrect;
}

function selectOption(idx, btn){
  if(answered) return;
  answered = true;
  const block = blocks[currentBlock];
  const q = block.questions[currentQuestion];
  const children = Array.from(optionsEl.children);
  children.forEach((el, i)=>{
    if(i === q.answer) el.classList.add('correct');
    if(i === idx && i !== q.answer) el.classList.add('wrong');
    el.disabled = true;
  });

  // обновляем счетчики если правильно
  if(idx === q.answer){
    totalCorrect++;
    blockCorrect++;
    blockCorrectEl.textContent = blockCorrect;
    totalCorrectEl.textContent = totalCorrect;
  }

  // через короткую паузу — следующий вопрос или AR-панель
  setTimeout(()=>{
    if(currentQuestion < block.questions.length - 1){
      currentQuestion++;
      answered = false;
      renderQuestion();
      window.scrollTo({top:0,behavior:'smooth'});
    } else {
      // конец блока — показать AR / placeholder
      showARForBlock(currentBlock);
    }
  }, 700);
}

function showARForBlock(blockIndex){
  quiz.classList.add('hidden');
  arPanel.classList.remove('hidden');
  const b = blocks[blockIndex];
  arTitle.textContent = `Блок ${blockIndex+1} — ${b.title}`;
  arMsg.textContent = `Блок ${blockIndex+1} завершён. Правильных ответов в блоке: ${blockCorrect}. Нажми "Продолжить" чтобы перейти дальше.`;
  window.scrollTo({top:0,behavior:'smooth'});
}

continueBtn.addEventListener('click', ()=>{
  arPanel.classList.add('hidden');
  currentBlock++;
  if(currentBlock >= blocks.length){
    showFinal();
  } else {
    // сброс счетчика блока
    blockCorrect = 0;
    currentQuestion = 0;
    answered = false;
    quiz.classList.remove('hidden');
    renderQuestion();
  }
});

function showFinal(){
  quiz.classList.add('hidden');
  arPanel.classList.add('hidden');
  final.classList.remove('hidden');
  finalTotal.textContent = totalCorrect;
  document.getElementById('final-text').textContent = `Викторина завершена — правильных ответов: ${totalCorrect}`;
}

restart.addEventListener('click', ()=>{
  // сброс состояния
  currentBlock = 0;
  currentQuestion = 0;
  answered = false;
  totalCorrect = 0;
  blockCorrect = 0;
  final.classList.add('hidden');
  quiz.classList.remove('hidden');
  renderQuestion();
  window.scrollTo({top:0,behavior:'smooth'});
});

// старт
renderQuestion();
</script>
</body>
</html>
